+++
title= "LinuxTips16"
date = "2023-11-27T11:37:08+08:00"
description = "LinuxTips16"
keywords = ["Technology"]
categories = ["Technology"]
+++
### 1. ArchLinux ctg items
Install nomachine:    

```
$ export https_proxy=http://192.168.1.194:10809
$ export http_proxy=http://192.168.1.194:10809
$ yay  --sudoflags="http_proxy=http://192.168.1.194:10809 https_proxy=http://192.168.1.194:10809" nomachine
```
Configure auto-login refers to `2021-06-15-iPadiPhoneMirroringDisplay.md`    

connecting to :    

![/images/2023_11_27_11_40_04_660x179.jpg](/images/2023_11_27_11_40_04_660x179.jpg)

### 2. conda deactivate base
via:    

```
conda config --set auto_activate_base false
```
Doing this could let python to be set to system default.    

```
$ which python3
/usr/bin/python3
```

### 3. lxc with nvidia support
Start a lxc instance via:    

```
$ sudo lxc launch images:ubuntu/jammy lxcnvidia
Creating lxcnvidia
Starting lxcnvidia                        
$ sudo lxc config set lxcnvidia nvidia.driver.capabilities=all
$ sudo lxc config show lxcnvidia  | grep nvidia
  nvidia.driver.capabilities: all
```
Configure in lxc instance:    

```
$ sudo lxc exec lxcnvidia bash
root@lxcnvidia:~# 
```
### 4. lxc with nvidia(correct way)
Steps:   

```
lxc launch ubuntu:18.04 cuda -c nvidia.runtime=true
lxc config device add cuda gpu gpu
lxc exec cuda -- nvidia-smi
```
### 5. lxc add second nic(macvlan)
Create a new profile:   

```
$ cat macvlan
config: {}
description: Default LXD profile modified for using macvlan
devices:
  eth1:
    nictype: macvlan
    parent: enp3s0 
    type: nic
name: macvlan
```
Create this new profile:    

```
# lxc profile edit macvlan<macvlan
# lxc config edit cuda
    profiles:
    - default
+++    - macvlan
# lxc restart cuda
# lxc exec cuda bash
dhclient eth1
```
Then you got the address.      

Start the ui:    

```
dash@cuda:~/webui$ ./webui.sh 

################################################################
Install script for stable-diffusion + Web UI
Tested on Debian 11 (Bullseye)
################################################################

``` 
Should change its listening address to `0.0.0.0`

### 6. lxc on ubuntu22.04
not started, solved via:    

```
GRUB_CMDLINE_LINUX_DEFAULT="quiet splash systemd.unified_cgroup_hierarchy=false"

```

### 7. ipmi set address
set bmc port's ip address to `192.168.2.167`, gateway `192.168.2.1` via:    

```
 ipmitool lan set 1 ipsrc static
 ipmitool lan set 1 ipaddr 192.168.2.167
 ipmitool lan set 1 defgw ipaddr 192.168.2.1
 ipmitool lan print 1
```

### 8. apt-cache policy alternative
in yum, via:    

```
yum --showduplicates list 
```

### 9. cut video using ffmpeg
cut unnecessary part and combine then again:     

```
$ ffmpeg -ss 00:00:06 -t 00:03:43 -i SLXC-2023-12-08_11.25.03.mp4 -vcodec copy -acodec copy split1.mp4
$ ffmpeg -ss 00:05:55 -t 00:09:00 -i SLXC-2023-12-08_11.25.03.mp4 -vcodec copy -acodec copy split2.mp4
$ ffmpeg -ss 00:15:46 -t 00:00:35 -i SLXC-2023-12-08_11.25.03.mp4 -vcodec copy -acodec copy split3.mp4
$ vim list.txt
file ./split1.mp4
file ./split2.mp4
file ./split3.mp4
$ ffmpeg -f concat -safe 0 -i list.txt -c:v copy vdiidvRONG.mp4
```

### 10. NFS server(ubuntu22.04)
Steps:    

```
sudo apt update
sudo apt install nfs-kernel-server
sudo mkdir -p /mnt/nfs_share
sudo chown -R nobody:nogroup /mnt/nfs_share/
sudo chmod 777 /mnt/nfs_share/
sudo nano /etc/exports
/mnt/nfs_share 192.168.1.1/24(rw,sync,no_subtree_check)
sudo exportfs -a
sudo systemctl restart nfs-kernel-server
sudo systemctl enable nfs-kernel-server
```
mount via:    

```
sudo mount -t nfs 192.168.1.194:/mnt/nfs_share /mnt

```

### 11. install casaos
via:     

```
curl -fsSL https://get.casaos.io | sudo bash
```

### 12. rst2html issue 
Solved via:      

```
apt-get install python3-docutils
```

### 13. redroid and webui
via:    

```
docker run -itd --privileged -v /root/scrcpy-web/data:/data --name scrcpy-web -p 48000:8000/tcp --link redroid12:myphone1 emptysuns/scrcpy-web:v0.1
docker run -itd --name redroid12  --privileged -p 5555:5555 redroid12:latest androidboot.use_memfd=1
```
Should re-write using docker-compose.   
